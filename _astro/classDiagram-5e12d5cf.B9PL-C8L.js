import{Y as A,K as B,z as C}from"./styles-13ae24cf.CjnbiHAx.js";import{e as H,L as f,T as N,a as W,s as $,f as v,F as D}from"./mermaid.esm.min.DcOAKCd2.js";import{Y as J}from"./graph-80608c14.roq2Worl.js";import{W as X}from"./layout-0254eb32.CdDZ1vV8.js";import{P as Z}from"./line-0c78f995.BxgWd223.js";import"./MarkdownExtract.379YtPSC.js";import"./Footer.uysjqDA6.js";import"./snippet.DAV2K58k.js";/* empty css                              */import"./index.Z7aoFuSQ.js";import"./Introduction.DIPUZYz7.js";import"./BentoCard.BKdmkTMr.js";import"./scrollReveal.BIX1P6ww.js";/* empty css                              *//* empty css                       */import"./array-2ff2c7a6.C3YJfAyO.js";import"./path-428ebac9.B0oSrkCJ.js";let O=0;const P=function(i,r,t,s,p){const c=function(n){switch(n){case p.db.relationType.AGGREGATION:return"aggregation";case p.db.relationType.EXTENSION:return"extension";case p.db.relationType.COMPOSITION:return"composition";case p.db.relationType.DEPENDENCY:return"dependency";case p.db.relationType.LOLLIPOP:return"lollipop"}};r.points=r.points.filter(n=>!Number.isNaN(n.y));const o=r.points,g=Z().x(function(n){return n.x}).y(function(n){return n.y}).curve($),d=i.append("path").attr("d",g(o)).attr("id","edge"+O).attr("class","relation");let a="";s.arrowMarkerAbsolute&&(a=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,a=a.replace(/\(/g,"\\("),a=a.replace(/\)/g,"\\)")),t.relation.lineType==1&&d.attr("class","relation dashed-line"),t.relation.lineType==10&&d.attr("class","relation dotted-line"),t.relation.type1!=="none"&&d.attr("marker-start","url("+a+"#"+c(t.relation.type1)+"Start)"),t.relation.type2!=="none"&&d.attr("marker-end","url("+a+"#"+c(t.relation.type2)+"End)");let u,l;const x=r.points.length;let m=v.calcLabelPosition(r.points);u=m.x,l=m.y;let b,w,e,h;if(x%2!==0&&x>1){let n=v.calcCardinalityPosition(t.relation.type1!=="none",r.points,r.points[0]),y=v.calcCardinalityPosition(t.relation.type2!=="none",r.points,r.points[x-1]);f.debug("cardinality_1_point "+JSON.stringify(n)),f.debug("cardinality_2_point "+JSON.stringify(y)),b=n.x,w=n.y,e=y.x,h=y.y}if(t.title!==void 0){const n=i.append("g").attr("class","classLabel"),y=n.append("text").attr("class","label").attr("x",u).attr("y",l).attr("fill","red").attr("text-anchor","middle").text(t.title);window.label=y;const L=y.node().getBBox();n.insert("rect",":first-child").attr("class","box").attr("x",L.x-s.padding/2).attr("y",L.y-s.padding/2).attr("width",L.width+s.padding).attr("height",L.height+s.padding)}f.info("Rendering relation "+JSON.stringify(t)),t.relationTitle1!==void 0&&t.relationTitle1!=="none"&&i.append("g").attr("class","cardinality").append("text").attr("class","type1").attr("x",b).attr("y",w).attr("fill","black").attr("font-size","6").text(t.relationTitle1),t.relationTitle2!==void 0&&t.relationTitle2!=="none"&&i.append("g").attr("class","cardinality").append("text").attr("class","type2").attr("x",e).attr("y",h).attr("fill","black").attr("font-size","6").text(t.relationTitle2),O++},G=function(i,r,t,s){f.debug("Rendering class ",r,t);const p=r.id,c={id:p,label:r.id,width:0,height:0},o=i.append("g").attr("id",s.db.lookUpDomId(p)).attr("class","classGroup");let g;r.link?g=o.append("svg:a").attr("xlink:href",r.link).attr("target",r.linkTarget).append("text").attr("y",t.textHeight+t.padding).attr("x",0):g=o.append("text").attr("y",t.textHeight+t.padding).attr("x",0);let d=!0;r.annotations.forEach(function(n){const y=g.append("tspan").text("«"+n+"»");d||y.attr("dy",t.textHeight),d=!1});let a=Y(r);const u=g.append("tspan").text(a).attr("class","title");d||u.attr("dy",t.textHeight);const l=g.node().getBBox().height;let x,m,b;if(r.members.length>0){x=o.append("line").attr("x1",0).attr("y1",t.padding+l+t.dividerMargin/2).attr("y2",t.padding+l+t.dividerMargin/2);const n=o.append("text").attr("x",t.padding).attr("y",l+t.dividerMargin+t.textHeight).attr("fill","white").attr("class","classText");d=!0,r.members.forEach(function(y){S(n,y,d,t),d=!1}),m=n.node().getBBox()}if(r.methods.length>0){b=o.append("line").attr("x1",0).attr("y1",t.padding+l+t.dividerMargin+m.height).attr("y2",t.padding+l+t.dividerMargin+m.height);const n=o.append("text").attr("x",t.padding).attr("y",l+2*t.dividerMargin+m.height+t.textHeight).attr("fill","white").attr("class","classText");d=!0,r.methods.forEach(function(y){S(n,y,d,t),d=!1})}const w=o.node().getBBox();var e=" ";r.cssClasses.length>0&&(e=e+r.cssClasses.join(" "));const h=o.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",w.width+2*t.padding).attr("height",w.height+t.padding+.5*t.dividerMargin).attr("class",e).node().getBBox().width;return g.node().childNodes.forEach(function(n){n.setAttribute("x",(h-n.getBBox().width)/2)}),r.tooltip&&g.insert("title").text(r.tooltip),x&&x.attr("x2",h),b&&b.attr("x2",h),c.width=h,c.height=w.height+t.padding+.5*t.dividerMargin,c},Y=function(i){let r=i.id;return i.type&&(r+="<"+D(i.type)+">"),r},I=function(i,r,t,s){f.debug("Rendering note ",r,t);const p=r.id,c={id:p,text:r.text,width:0,height:0},o=i.append("g").attr("id",p).attr("class","classGroup");let g=o.append("text").attr("y",t.textHeight+t.padding).attr("x",0);const d=JSON.parse(`"${r.text}"`).split(`
`);d.forEach(function(l){f.debug(`Adding line: ${l}`),g.append("tspan").text(l).attr("class","title").attr("dy",t.textHeight)});const a=o.node().getBBox(),u=o.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",a.width+2*t.padding).attr("height",a.height+d.length*t.textHeight+t.padding+.5*t.dividerMargin).node().getBBox().width;return g.node().childNodes.forEach(function(l){l.setAttribute("x",(u-l.getBBox().width)/2)}),c.width=u,c.height=a.height+d.length*t.textHeight+t.padding+.5*t.dividerMargin,c},S=function(i,r,t,s){const{displayText:p,cssStyle:c}=r.getDisplayDetails(),o=i.append("tspan").attr("x",s.padding).text(p);c!==""&&o.attr("style",r.cssStyle),t||o.attr("dy",s.textHeight)},M={getClassTitleString:Y,drawClass:G,drawEdge:P,drawNote:I};let T={};const E=20,k=function(i){const r=Object.entries(T).find(t=>t[1].label===i);if(r)return r[0]},R=function(i){i.append("defs").append("marker").attr("id","extensionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),i.append("defs").append("marker").attr("id","extensionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z"),i.append("defs").append("marker").attr("id","compositionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id","compositionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id","aggregationStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id","aggregationEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id","dependencyStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},U=function(i,r,t,s){const p=H().class;T={},f.info("Rendering diagram "+i);const c=H().securityLevel;let o;c==="sandbox"&&(o=N("#i"+r));const g=c==="sandbox"?N(o.nodes()[0].contentDocument.body):N("body"),d=g.select(`[id='${r}']`);R(d);const a=new J({multigraph:!0});a.setGraph({isMultiGraph:!0}),a.setDefaultEdgeLabel(function(){return{}});const u=s.db.getClasses(),l=Object.keys(u);for(const e of l){const h=u[e],n=M.drawClass(d,h,p,s);T[n.id]=n,a.setNode(n.id,n),f.info("Org height: "+n.height)}s.db.getRelations().forEach(function(e){f.info("tjoho"+k(e.id1)+k(e.id2)+JSON.stringify(e)),a.setEdge(k(e.id1),k(e.id2),{relation:e},e.title||"DEFAULT")}),s.db.getNotes().forEach(function(e){f.debug(`Adding note: ${JSON.stringify(e)}`);const h=M.drawNote(d,e,p,s);T[h.id]=h,a.setNode(h.id,h),e.class&&e.class in u&&a.setEdge(e.id,k(e.class),{relation:{id1:e.id,id2:e.class,relation:{type1:"none",type2:"none",lineType:10}}},"DEFAULT")}),X(a),a.nodes().forEach(function(e){e!==void 0&&a.node(e)!==void 0&&(f.debug("Node "+e+": "+JSON.stringify(a.node(e))),g.select("#"+(s.db.lookUpDomId(e)||e)).attr("transform","translate("+(a.node(e).x-a.node(e).width/2)+","+(a.node(e).y-a.node(e).height/2)+" )"))}),a.edges().forEach(function(e){e!==void 0&&a.edge(e)!==void 0&&(f.debug("Edge "+e.v+" -> "+e.w+": "+JSON.stringify(a.edge(e))),M.drawEdge(d,a.edge(e),a.edge(e).relation,p,s))});const x=d.node().getBBox(),m=x.width+E*2,b=x.height+E*2;W(d,b,m,p.useMaxWidth);const w=`${x.x-E} ${x.y-E} ${m} ${b}`;f.debug(`viewBox ${w}`),d.attr("viewBox",w)},F={draw:U},lt={parser:C,db:B,renderer:F,styles:A,init:i=>{i.class||(i.class={}),i.class.arrowMarkerAbsolute=i.arrowMarkerAbsolute,B.clear()}};export{lt as diagram};
